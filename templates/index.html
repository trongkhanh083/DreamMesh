<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DreamMesh</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script type="importmap">
        {
            "imports": {
            "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
            "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>
    <link rel="stylesheet" href="/static/css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <link type="image/png" sizes="16x16" rel="icon" href="/static/icons8-3d-16.png">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <i class="fas fa-cube"></i>
                <h1>DreamMesh</h1>
            </div>
            <p class="tagline">Transform text and images into stunning 3D models with AI</p>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Generation Panel -->
            <section class="generation-panel">
                <div class="panel-header">
                    <h2><i class="fas fa-magic"></i> Create 3D Model</h2>
                    <div class="tab-switcher">
                        <button class="tab-btn active" data-tab="text-tab" onclick="switchTab('text-tab', event)">
                            <i class="fas fa-font"></i> Text to 3D
                        </button>
                        <button class="tab-btn" data-tab="image-tab" onclick="switchTab('image-tab', event)">
                            <i class="fas fa-image"></i> Image to 3D
                        </button>
                    </div>
                </div>

                <!-- Text to 3D Tab -->
                <div id="text-tab" class="tab-content active">
                    <div class="form-group">
                        <label for="prompt">
                            <i class="fas fa-comment"></i> Text Prompt
                        </label>
                        <div class="input-with-icon">
                            <textarea id="prompt" placeholder="Describe your 3D model..."></textarea>
                            <div class="char-count">0/500</div>
                        </div>
                        <div class="hint">
                            <i class="fas fa-lightbulb"></i> Keep it simple! Example: "A fantasy dragon"
                        </div>
                    </div>

                    <div class="form-grid">
                        <div class="form-group">
                            <label for="t2i-seed">
                                <i class="fas fa-seedling"></i> Seed
                            </label>
                            <input type="number" id="t2i-seed" placeholder="Empty for random" min="0">
                        </div>
                        <div class="form-group">
                            <label for="t2i-resolution">
                                <i class="fas fa-cube"></i> Quality
                            </label>
                            <select id="t2i-resolution">
                                <option value="128">Fast</option>
                                <option value="256" selected>Balanced</option>
                                <option value="380">Detailed</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="t2i-texture" checked>
                            <span class="checkmark"></span>
                            <i class="fas fa-paint-brush"></i> Enable Texture
                        </label>
                    </div>

                    <button class="generate-btn" id="text-generate-btn" onclick="generateFromText()">
                        <i class="fas fa-sparkles"></i> Generate
                    </button>
                </div>

                <!-- Image to 3D Tab -->
                <div id="image-tab" class="tab-content">
                    <div class="form-group">
                        <label>
                            <i class="fas fa-upload"></i> Upload Image
                        </label>
                        <div class="upload-area" id="upload-area">
                            <i class="fas fa-cloud-upload-alt upload-icon"></i>
                            <p class="upload-text">Drag & drop your image here</p>
                            <p class="upload-subtext">or click to browse (PNG, JPG, JPEG)</p>
                            <input type="file" id="file-input" accept="image/*" hidden>
                            <button class="browse-btn" onclick="document.getElementById('file-input').click()">
                                Browse Files
                            </button>
                        </div>
                        <div id="image-preview" class="hidden">
                            <div class="preview-container">
                                <img id="preview-image" alt="Selected image preview">
                                <button class="remove-btn" onclick="removeImage()">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="form-grid">
                        <div class="form-group">
                            <label for="i2i-seed">
                                <i class="fas fa-seedling"></i> Seed
                            </label>
                            <input type="number" id="i2i-seed" placeholder="Empty for random" min="0">
                        </div>
                        <div class="form-group">
                            <label for="i2i-resolution">
                                <i class="fas fa-cube"></i> Quality
                            </label>
                            <select id="i2i-resolution">
                                <option value="128">Fast</option>
                                <option value="256" selected>Balanced</option>
                                <option value="380">Detailed</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="i2i-texture" checked>
                            <span class="checkmark"></span>
                            <i class="fas fa-paint-brush"></i> Enable Texture
                        </label>
                    </div>

                    <button class="generate-btn" id="image-generate-btn" onclick="generateFromImage()" disabled>
                        <i class="fas fa-sparkles"></i> Generate
                    </button>
                </div>

                <div class="info-box">
                    <i class="fas fa-info-circle"></i>
                    <p>Generation takes a few seconds depending on quality settings.</p>
                </div>
            </section>

            <!-- Results Panel -->
            <section class="results-panel">
                <div class="panel-header">
                    <h2><i class="fas fa-cube"></i> Generated Model</h2>
                    <div class="model-stats">
                        <span id="model-info">Result will display here</span>
                    </div>
                </div>

                <div class="model-viewer-container" id="model-view-container">
                    <div id="placeholder-view" class="placeholder">
                        <i class="fas fa-cube placeholder-icon"></i>
                        <p>Generate your first 3D model</p>
                    </div>
                    
                    <div id="threejs-container" class="hidden" style="width: 100%; height: 500px; border-radius: 8px; overflow: hidden;"></div>
                </div>
                
                <!-- Status Section -->
                <div class="status-section">
                    <div id="status-area"></div>
                    
                    <div class="progress-container hidden" id="progress-container">
                        <div class="progress-header">
                            <span id="progress-text">Initializing...</span>
                            <span id="progress-percent">0%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progress-fill"></div>
                        </div>
                        <div class="progress-steps">
                            <div class="step active" id="step-1">
                                <div class="step-icon">1</div>
                                <span>Processing</span>
                            </div>
                            <div class="step" id="step-2">
                                <div class="step-icon">2</div>
                                <span>Gen Shape</span>
                            </div>
                            <div class="step" id="step-3">
                                <div class="step-icon">3</div>
                                <span>Gen Texture</span>
                            </div>
                            <div class="step" id="step-4">
                                <div class="step-icon">4</div>
                                <span>Completed</span>
                            </div>
                        </div>
                    </div>

                    <!-- Actions -->
                    <div class="actions-container hidden" id="actions-container">
                        <div class="action-buttons">
                            <button class="action-btn download-btn" onclick="downloadModel()">
                                <i class="fas fa-download"></i> Download
                            </button>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>DreamMesh</h3>
                    <p>AI-powered 3D model generation</p>
                </div>
                <div class="footer-section">
                    <h3>Resources</h3>
                    <a href="https://github.com/trongkhanh083/DreamMesh" target="_blank">
                        <i class="fab fa-github"></i> GitHub
                    </a>
                </div>
                <div class="footer-section">
                    <h3>Settings</h3>
                    <div class="server-status">
                        <div class="status-indicator" id="server-status"></div>
                        <span>Server Status</span>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>
    
    <script type="module" src="/static/js/main.js"></script>
</body>
</html>